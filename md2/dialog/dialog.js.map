{"version":3,"file":"dialog.js","sourceRoot":"","sources":["../../../src/lib/dialog/dialog.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  Component,\n  Output,\n  Input,\n  EventEmitter,\n  ViewChild,\n  ViewEncapsulation,\n  OnDestroy,\n  Directive,\n  ViewContainerRef,\n  style,\n  trigger,\n  state,\n  transition,\n  animate,\n  TemplateRef,\n  NgModule,\n  ModuleWithProviders\n} from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport {\n  Overlay,\n  OverlayState,\n  OverlayRef,\n  OverlayModule,\n  TemplatePortalDirective\n} from '../core/core';\nimport { extendObject } from '../core/util/object-extend';\nimport { Subscription } from 'rxjs/Subscription';\nimport 'rxjs/add/operator/first';\n\nexport type DialogVisibility = 'initial' | 'visible' | 'hidden';\nexport type DialogRole = 'dialog' | 'alertdialog';\n\nexport class Md2DialogConfig {\n  role?: DialogRole = 'dialog';\n  disableClose?: boolean = false;\n}\n\n@Directive({ selector: '[md2DialogPortal]' })\nexport class Md2DialogPortal extends TemplatePortalDirective {\n  constructor(templateRef: TemplateRef<any>, viewContainerRef: ViewContainerRef) {\n    super(templateRef, viewContainerRef);\n  }\n}\n\n/**\n * Title of a dialog element. Stays fixed to the top of the dialog when scrolling.\n */\n@Directive({ selector: 'md2-dialog-title' })\nexport class Md2DialogTitle { }\n\n/**\n * Scrollable content container of a dialog.\n */\n@Directive({ selector: 'md2-dialog-content' })\nexport class Md2DialogContent { }\n\n/**\n * Container for the bottom action buttons in a dialog.\n * Stays fixed to the bottom when scrolling.\n */\n@Directive({ selector: 'md2-dialog-footer, md2-dialog-actions' })\nexport class Md2DialogActions { }\n\n@Component({\n  moduleId: module.id,\n  selector: 'md2-dialog',\n  templateUrl: 'dialog.html',\n  styleUrls: ['dialog.css'],\n  host: {\n    'tabindex': '0',\n    '[attr.role]': 'config?.role',\n    '(body:keydown.esc)': '_handleEscKeydown($event)'\n  },\n  animations: [\n    trigger('state', [\n      state('void', style({ transform: 'scale(0.3)' })),\n      state('initial', style({ transform: 'scale(0.3)' })),\n      state('visible', style({ transform: 'scale(1)' })),\n      state('hidden', style({ transform: 'scale(0.3)' })),\n      transition('* => visible', animate('150ms cubic-bezier(0.0, 0.0, 0.2, 1)')),\n      transition('* => hidden', animate('150ms cubic-bezier(0.4, 0.0, 1, 1)')),\n    ])\n  ],\n  encapsulation: ViewEncapsulation.None,\n  exportAs: 'md2Dialog'\n})\nexport class Md2Dialog implements OnDestroy {\n\n  private _panelOpen = false;\n  private _overlayRef: OverlayRef = null;\n  private _backdropSubscription: Subscription;\n  config: Md2DialogConfig;\n\n  /** Property watched by the animation framework to show or hide the dialog */\n  _visibility: DialogVisibility = 'initial';\n\n  constructor(private _overlay: Overlay) { }\n\n  @Output() onOpen: EventEmitter<Md2Dialog> = new EventEmitter<Md2Dialog>();\n  @Output() onClose: EventEmitter<any> = new EventEmitter<any>();\n\n  /** The portal to send the dialog content through */\n  @ViewChild(Md2DialogPortal) _portal: Md2DialogPortal;\n\n  @Input('title') dialogTitle: string;\n\n  ngOnDestroy() { this.destroyPanel(); }\n\n  /** Open the dialog */\n  open(config?: Md2DialogConfig): Promise<Md2Dialog> {\n    this.config = _applyConfigDefaults(config);\n    if (this._panelOpen) {\n      return Promise.resolve<Md2Dialog>(this);\n    }\n    this._createOverlay();\n    this._overlayRef.attach(this._portal);\n    this._subscribeToBackdrop();\n    this._panelOpen = true;\n    this._visibility = 'visible';\n    return Promise.resolve<Md2Dialog>(this);\n  }\n\n  /** Close the dialog */\n  close(): Promise<Md2Dialog> {\n    this._visibility = 'hidden';\n    this._panelOpen = false;\n    if (this._overlayRef) {\n      this._overlayRef.detach();\n      if (this._backdropSubscription) {\n        this._backdropSubscription.unsubscribe();\n      }\n    }\n    return Promise.resolve<Md2Dialog>(this);\n  }\n\n  /** Removes the panel from the DOM. */\n  destroyPanel(): void {\n    if (this._overlayRef) {\n      this._overlayRef.dispose();\n      this._overlayRef = null;\n\n      this._cleanUpSubscriptions();\n    }\n  }\n\n  _onPanelDone(): void {\n    if (this._panelOpen) {\n      this.onOpen.emit(this);\n    } else {\n      this.onClose.emit();\n    }\n  }\n\n  _handleEscKeydown(event: KeyboardEvent) {\n    if (this._panelOpen && !this.config.disableClose) {\n      this.close();\n    }\n  }\n\n  private _subscribeToBackdrop(): void {\n    if (!this.config.disableClose) {\n      this._backdropSubscription = this._overlayRef.backdropClick().first().subscribe(() => this.close());\n    }\n  }\n\n  private _createOverlay(): void {\n    if (!this._overlayRef) {\n      let config = new OverlayState();\n      config.positionStrategy = this._overlay.position()\n        .global()\n        .centerHorizontally()\n        .centerVertically();\n      config.hasBackdrop = true;\n\n      this._overlayRef = this._overlay.create(config);\n    }\n  }\n\n  private _cleanUpSubscriptions(): void {\n    if (this._backdropSubscription) {\n      this._backdropSubscription.unsubscribe();\n    }\n  }\n\n}\n\n/**\n * Applies default options to the dialog config.\n * @param dialogConfig Config to be modified.\n * @returns The new configuration object.\n */\nfunction _applyConfigDefaults(dialogConfig: Md2DialogConfig): Md2DialogConfig {\n  return extendObject(new Md2DialogConfig(), dialogConfig);\n}\n\nexport const MD2_DIALOG_DIRECTIVES: any[] = [\n  Md2Dialog,\n  Md2DialogTitle,\n  Md2DialogContent,\n  Md2DialogActions,\n  Md2DialogPortal\n];\n\n@NgModule({\n  imports: [CommonModule, OverlayModule],\n  exports: MD2_DIALOG_DIRECTIVES,\n  declarations: MD2_DIALOG_DIRECTIVES,\n})\nexport class Md2DialogModule {\n  static forRoot(): ModuleWithProviders {\n    return {\n      ngModule: Md2DialogModule,\n      providers: []\n    };\n  }\n}\n"]}