{"version":3,"sources":["toast/toast.ts"],"names":[],"mappings":"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","file":"toast.js","sourcesContent":["import {\r\n  ApplicationRef,\r\n  ComponentFactoryResolver,\r\n  ComponentRef,\r\n  Injectable,\r\n  Optional,\r\n  ReflectiveInjector,\r\n  ViewContainerRef,\r\n  NgModule,\r\n  ModuleWithProviders\r\n} from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { Md2ToastComponent } from './toast.component';\r\n\r\nexport class Toast {\r\n  id: number;\r\n  isVisible: boolean;\r\n  constructor(public message: string) { }\r\n}\r\n\r\n@Injectable()\r\nexport class Md2Toast {\r\n  private delay: number = 3000;\r\n  private index: number = 0;\r\n\r\n  container: ComponentRef<any>;\r\n\r\n  constructor(private _componentFactory: ComponentFactoryResolver, private _appRef: ApplicationRef) { }\r\n\r\n  /**\r\n   * toast message\r\n   * @param toast string or object with message and other properties of toast\r\n   */\r\n  toast(toast: string | { message: string, hideDelay: number }) {\r\n    this.show(toast);\r\n  }\r\n\r\n  /**\r\n   * show toast\r\n   * @param toastObj string or object with message and other properties of toast\r\n   */\r\n  show(toastObj: string | { message: string, hideDelay: number }) {\r\n    let toast: Toast;\r\n    if (typeof toastObj === 'string') {\r\n      toast = new Toast(toastObj);\r\n    } else if (typeof toastObj === 'object') {\r\n      toast = new Toast(toastObj.message);\r\n      this.delay = toastObj.hideDelay;\r\n    }\r\n    if (toast) {\r\n      if (!this.container) {\r\n        let app: any = this._appRef;\r\n        let appContainer: ViewContainerRef = app['_rootComponents'][0]['_hostElement'].vcRef;\r\n\r\n        let providers = ReflectiveInjector.resolve([]);\r\n\r\n        let toastFactory = this._componentFactory.resolveComponentFactory(Md2ToastComponent);\r\n        let childInjector = ReflectiveInjector.fromResolvedProviders(providers, appContainer.parentInjector);\r\n        this.container = appContainer.createComponent(toastFactory, appContainer.length, childInjector);\r\n        this.setupToast(toast);\r\n\r\n      } else {\r\n        this.setupToast(toast);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * toast timeout\r\n   * @param toastId\r\n   */\r\n  startTimeout(toastId: number) {\r\n    setTimeout(() => {\r\n      this.clear(toastId);\r\n    }, this.delay);\r\n  }\r\n\r\n  /**\r\n   * setup toast\r\n   * @param toast\r\n   */\r\n  setupToast(toast: Toast) {\r\n    toast.id = ++this.index;\r\n    this.container.instance.add(toast);\r\n    this.startTimeout(toast.id);\r\n  }\r\n\r\n  /**\r\n   * clear specific toast\r\n   * @param toastId\r\n   */\r\n  clear(toastId: number) {\r\n    if (this.container) {\r\n      let instance = this.container.instance;\r\n      instance.remove(toastId);\r\n      setTimeout(() => {\r\n        if (!instance.hasToast()) { this.dispose(); }\r\n      }, 250);\r\n\r\n    }\r\n  }\r\n\r\n  /**\r\n   * clear all toasts\r\n   */\r\n  clearAll() {\r\n    if (this.container) {\r\n      let instance = this.container.instance;\r\n      instance.removeAll();\r\n      setTimeout(() => {\r\n        if (!instance.hasToast()) { this.dispose(); }\r\n      }, 250);\r\n\r\n    }\r\n  }\r\n\r\n  /**\r\n   * dispose all toasts\r\n   */\r\n  dispose() {\r\n    this.container.destroy();\r\n    this.container = null;\r\n  }\r\n\r\n}\r\n\r\nexport const MD2_TOAST_DIRECTIVES: any[] = [Md2ToastComponent];\r\n\r\n@NgModule({\r\n  imports: [CommonModule],\r\n  exports: MD2_TOAST_DIRECTIVES,\r\n  declarations: MD2_TOAST_DIRECTIVES,\r\n  providers: [Md2Toast],\r\n  entryComponents: MD2_TOAST_DIRECTIVES\r\n})\r\nexport class Md2ToastModule {\r\n  static forRoot(): ModuleWithProviders {\r\n    return {\r\n      ngModule: Md2ToastModule,\r\n      providers: []\r\n    };\r\n  }\r\n}\r\n"]}